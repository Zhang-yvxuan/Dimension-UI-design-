<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AIåŠ©æ‰‹ - æ¸¡ç‰© Dimension</title>
  <link rel="stylesheet" href="assets/css/style.css">
  <style>
    .chat-container {
      max-height: 60vh;
      overflow-y: auto;
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: var(--gap);
      margin-bottom: var(--gap);
      background: var(--color7);
    }
    .message {
      margin-bottom: var(--gap);
      padding: 0.5rem;
      border-radius: 0.5rem;
      max-width: 80%;
    }
    .message.user {
      background: var(--primary);
      color: #fff;
      margin-left: auto;
    }
    .message.ai {
      background: var(--card-bg);
      color: var(--text);
    }
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      z-index: 300;
      justify-content: center;
      align-items: center;
    }
    .modal img {
      max-width: 90%;
      max-height: 90%;
    }
  </style>
</head>

<div class="logo-sticker">
  <img src="assets/images/logo.png" alt="æ¸¡ç‰© Dimension Logo">
</div>

<div class="top-right-img">
    <img src="assets/images/right_nav.png" alt="top right image">
</div>

<header class="site-header">
  <div class="nav-container">

    <!-- å¯¼èˆªèœå• -->
    <nav class="nav-menu">
	  <div class="nav-item">
          <a href="welcome.html">é¦–é¡µ</a>
        </div>
		
      <div class="nav-item">
        <a href="designs.html">è®¾è®¡</a>
      </div>
	  
      <div class="nav-item dropdown">
        <span><a href="categories.html"  style="color: var(--primary); font-weight: 600;">å•†å“<a></span>
        <div class="dropdown-content">
          <a href="categories.html#åŸºç¡€">åŸºç¡€
		  <img src="assets/images/1.png" alt="åŸºç¡€" class="menu-img">
		  </a>
          <a href="categories.html#ç¯ç±»">ç¯ç±»
		  <img src="assets/images/2.png" alt="ç¯ç±»" class="menu-img">
		  </a>
          <a href="categories.html#åºŠç±»">åºŠç±»
		  <img src="assets/images/3.png" alt="åºŠç±»" class="menu-img">
		  </a>
          <a href="categories.html#æ¡Œç±»">æ¡Œç±»
		  <img src="assets/images/4.png" alt="æ¡Œç±»" class="menu-img">
		  </a>
          <a href="categories.html#æ¤…ç±»">æ¤…ç±»
		  <img src="assets/images/5.png" alt="æ¤…ç±»" class="menu-img">
		  </a>
		  <a href="categories.html#å‡³ç±»">å‡³ç±»
		  <img src="assets/images/6.png" alt="å‡³ç±»" class="menu-img">
		  </a>
		  <a href="categories.html#æ²™å‘">æ²™å‘
		  <img src="assets/images/7.png" alt="æ²™å‘" class="menu-img">
		  </a>
		  <a href="categories.html#æŸœç±»">æŸœç±»
		  <img src="assets/images/8.png" alt="æŸœç±»" class="menu-img">
		  </a>
		  <a href="categories.html#æ¶ç±»">æ¶ç±»
		  <img src="assets/images/9.png" alt="æ¶ç±»" class="menu-img">
		  </a>
		  <a href="categories.html#è£…é¥°">è£…é¥°
		  <img src="assets/images/10.png" alt="è£…é¥°" class="menu-img">
		  </a>
		  <a href="categories.html#ç»„åˆ">ç»„åˆ
		  <img src="assets/images/11.png" alt="ç»„åˆ" class="menu-img">
		  </a>
		  <a href="categories.html#å…¶ä»–">å…¶ä»–
		  <img src="assets/images/12.png" alt="å…¶ä»–" class="menu-img">
		  </a>
        </div>
      </div>

      <div class="nav-item search">
        <input type="text" placeholder="æœç´¢å•†å“..." />
      </div>

      <div class="nav-item">
        <a href="settings.html">è®¾ç½®</a>
      </div>

      <div class="nav-item">
        <a href="user.html">ä¸ªäººä¸­å¿ƒ</a>
      </div>

      <div class="nav-item">
        <a href="contact.html">è”ç³»æˆ‘ä»¬</a>
      </div>
      <div class="nav-item">
          <button class="music-toggle btn btn-outline">ğŸµ</button>
      </div>
    </nav>
  </div>
</header>

<body>
<!-- å¯¼èˆªå ä½ï¼Œç¡®ä¿å†…å®¹ä¸è¢«é¡¶éƒ¨å¯¼èˆªé®æŒ¡ -->
  <div class="nav-spacer"></div>
  <div class="container">
    <h1 class="function_title">AIåŠ©æ‰‹</h1>
    <div class="form-card">
      <div class="chat-container" id="chatContainer"></div>
      <div class="flex flex-col gap-1">
        <label>
          <span>è¾“å…¥æ¶ˆæ¯</span>
          <input type="text" id="userInput" placeholder="è¾“å…¥æ‚¨çš„æ¶ˆæ¯...">
        </label>
        <button type="submit" class="btn" onclick="sendMessage()">å‘é€</button>
      </div>
    </div>
  </div>
  <div class="modal" id="imageModal">
    <img id="modalImage" src="" alt="æ”¾å¤§å›¾ç‰‡">
  </div>
  <footer class="site-footer">
    <p>Â© 2025 æ¸¡ç‰© Dimension. ä¿ç•™æ‰€æœ‰æƒåˆ©ã€‚</p>
  </footer>
  <script>
    // å›ºå®šè§’è‰²æç¤ºè¯
    const systemPrompt = "ä½ æ˜¯æ¸¡ç‰©Dimensionçš„AIåŠ©æ‰‹ï¼Œä¸“æ³¨äºæä¾›å®¶å±…è®¾è®¡å»ºè®®ï¼Œé£æ ¼ç®€æ´ã€ç°ä»£ï¼Œå›ç­”ä¸“ä¸šä¸”å…·è±¡åŒ–ï¼Œå¸®åŠ©ç”¨æˆ·ä¼˜åŒ–å®¤å†…å¸ƒå±€ä¸è£…é¥°é€‰æ‹©ã€‚";
    let messages = [{ role: "system", content: systemPrompt }];

    // å‘é€æ¶ˆæ¯
    async function sendMessage() {
      const userInput = document.getElementById('userInput').value.trim();
      if (!userInput) return;

      const chatContainer = document.getElementById('chatContainer');
      const loadingElement = document.createElement('div');
      loadingElement.id = 'loading';
      loadingElement.style.display = 'block';
      loadingElement.textContent = 'åŠ è½½ä¸­...';
      chatContainer.appendChild(loadingElement);

      // æ˜¾ç¤ºç”¨æˆ·æ¶ˆæ¯
      const userMessageDiv = document.createElement('div');
      userMessageDiv.className = 'message user';
      userMessageDiv.textContent = userInput;
      chatContainer.appendChild(userMessageDiv);
      chatContainer.scrollTop = chatContainer.scrollHeight;

      // æ·»åŠ åˆ°æ¶ˆæ¯è®°å½•
      messages.push({ role: "user", content: userInput });

      // æ¸…ç©ºè¾“å…¥æ¡†
      document.getElementById('userInput').value = '';

      // è°ƒç”¨DeepSeek API
      try {
        const response = await fetch('https://api.deepseek.com/chat/completions', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Authorization': 'Bearer sk-5667c8b26be74ec5904616e7638ffc1e' // æ›¿æ¢ä¸ºå®é™…APIå¯†é’¥
          },
          body: JSON.stringify({
            model: 'deepseek-chat',
            messages: messages,
            stream: false
          })
        });

        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }

        const data = await response.json();
        const aiResponse = data.choices[0].message.content;

        // æ˜¾ç¤ºAIå›å¤
        const aiMessageDiv = document.createElement('div');
        aiMessageDiv.className = 'message ai';
        aiMessageDiv.textContent = formatMessage(aiResponse); // ä½¿ç”¨formatMessageå¤„ç†å›å¤
        chatContainer.appendChild(aiMessageDiv);
        chatContainer.scrollTop = chatContainer.scrollHeight;

        // æ›´æ–°æ¶ˆæ¯è®°å½•
        messages.push({ role: "assistant", content: aiResponse });
      } catch (error) {
        console.error('APIè°ƒç”¨å¤±è´¥:', error);
        const errorMessageDiv = document.createElement('div');
        errorMessageDiv.className = 'message ai';
        errorMessageDiv.textContent = `é”™è¯¯ï¼š${error.message || 'ç½‘ç»œæˆ–APIé—®é¢˜ï¼Œè¯·æ£€æŸ¥å¯†é’¥åé‡è¯•ã€‚'}`;
        chatContainer.appendChild(errorMessageDiv);
        chatContainer.scrollTop = chatContainer.scrollHeight;
      } finally {
        // ç§»é™¤åŠ è½½åŠ¨ç”»
        if (loadingElement) {
          loadingElement.remove();
        }
      }
    }

    // æ ¼å¼åŒ–æ¶ˆæ¯ï¼ˆå¤ç”¨script.jsçš„é€»è¾‘ï¼‰
    function formatMessage(text) {
      if (!text) return '';
      let lines = text.split('\n');
      let formattedLines = lines.map(line => {
        line = line.replace(/\*\*(.*?)\*\*/g, '<span class="bold-text">$1</span>');
        return line;
      });
      return formattedLines.join('<br>');
    }

    // æŒ‰Enteré”®å‘é€æ¶ˆæ¯
    document.getElementById('userInput').addEventListener('keypress', (event) => {
      if (event.key === 'Enter' && !event.shiftKey) {
        event.preventDefault();
        sendMessage();
      }
    });

    // ä¸»é¢˜åˆ‡æ¢ï¼ˆå¤ç”¨script.jsï¼‰
    function toggleTheme() {
      document.body.classList.toggle('dark-mode');
      const chatContainer = document.querySelector('.chat-container');
      chatContainer.classList.toggle('dark-mode');
      localStorage.setItem('darkMode', document.body.classList.contains('dark-mode'));
    }
    document.addEventListener('DOMContentLoaded', () => {
      if (localStorage.getItem('darkMode') === 'true') {
        document.body.classList.add('dark-mode');
        document.querySelector('.chat-container').classList.add('dark-mode');
      }
    });
  </script>
      <script src="assets/js/search.js"></script>
    <script src="assets/js/music.js"></script>
</body>
</html>